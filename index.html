<script>
  const SUBMIT_URL = 'https://corsproxy.io/?https://script.google.com/macros/s/AKfycbyxUZawt9GspidEMVlM8Fz5s32fwBp4ykSpIOjR6W8fSmPeAQHcSQSoPTqH315dDhwC/exec';

  function submitData() {
    const amount = document.getElementById('amount').value;
    const subcategory = document.getElementById('subcategory').value;
    const category = document.getElementById('category').value;
    const categoryType = document.getElementById('categoryType').value;
    const nature = document.getElementById('nature').value;
    const mode = document.getElementById('mode').value;
    const description = document.getElementById('description').value;

    if (!amount || !subcategory || !category || !categoryType || !nature || !mode) {
      document.getElementById('statusMsg').textContent = "Please fill all required fields.";
      return;
    }

    const data = {
      amount,
      subcategory,
      category,
      categoryType,
      nature,
      mode,
      description
    };

    document.getElementById('statusMsg').textContent = "Sending...";

    fetch(SUBMIT_URL, {
      method: 'POST',
      body: JSON.stringify(data),
      headers: { 'Content-Type': 'application/json' }
    })
    .then(res => res.json())
    .then(result => {
      if (result.success) {
        document.getElementById('statusMsg').textContent = "✅ Expense saved!";
      } else {
        document.getElementById('statusMsg').textContent = "❌ Error: " + result.error;
      }
    })
    .catch(err => {
      document.getElementById('statusMsg').textContent = "❌ Submit failed: " + err.message;
    });
  }
</script>
